<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Excel File</title>
  
  <style>
    /* CSS Internal untuk mengatur lebar tabel dan scroll */
    /* Container untuk tabel dengan scroll */
    .excel-table-container {
      width: 50%; /* Setengah lebar layar laptop */
      height: 300px; /* Tinggi yang diinginkan untuk area scroll */
      overflow: auto; /* Menambahkan scroll jika konten melebihi batas */
      margin-top: 20px;
      border: 1px solid #ddd;
      padding: 10px;
      margin: 0 auto; /* Agar container berada di tengah halaman */
    }

    /* Tampilan tabel agar lebih kecil */
    table {
      width: 100%;
      font-size: 12px; /* Menurunkan ukuran font agar lebih kecil */
      border-collapse: collapse;
    }

    table th, table td {
      padding: 5px; /* Menurunkan padding untuk ukuran tabel lebih kecil */
      border: 1px solid #ddd;
      text-align: left;
    }

    h1, h2 {
      color: #333;
      font-size: 16px; /* Ukuran font heading */
    }

    p {
      font-size: 14px;
      line-height: 1.5;
    }
  </style>

</head>
<body>

  <section id="view-excel">
    <h2>View Excel File<a class="headerlink" href="#view-excel" title="Link to this heading">#</a></h2>
    <p>Berikut adalah tampilan data dari file Excel <strong>p2_project.xlsx</strong>. Pilih sheet yang ingin ditampilkan:</p>

    <!-- Dropdown untuk memilih sheet -->
    <select id="sheetSelector" onchange="loadSheetData()">
      <option value="">Pilih Sheet</option>
    </select>

    <div class="excel-table-container">
      <table id="excelTable" border="1"></table>
    </div>
  </section>

  <section id="evaluasi">
    <h2>5. Evaluasi<a class="headerlink" href="#evaluasi" title="Link to this heading">#</a></h2>
    <p>Sebelum melakukan evaluasi, penting untuk memastikan bahwa proses validasi model dilakukan secara konsisten, termasuk pembagian dataset menjadi data latih dan data uji yang representatif. Dalam eksperimen ini, kinerja model diukur menggunakan dua metrik utama: Root Mean Squared Error (RMSE) dan Mean Absolute Percentage Error (MAPE). RMSE digunakan untuk mengukur rata-rata kesalahan prediksi dalam satuan asli data, sementara MAPE memberikan gambaran persentase deviasi rata-rata dari nilai aktual.</p>
    <p>Evaluasi dari kedua model prediksi menunjukkan perbedaan performa yang signifikan. Model ensemble bagging dengan regresi linier menghasilkan RMSE sebesar 0.0962 dan MAPE sebesar 10.96%, yang menunjukkan kesalahan prediksi yang relatif kecil dan deviasi rata-rata yang terkontrol, menjadikannya model yang lebih akurat dan dapat diandalkan untuk prediksi. Di sisi lain, model SVR (Support Vector Regression) menghasilkan RMSE sebesar 0.1092 dan MAPE sebesar 13.24%, yang sedikit lebih tinggi, menunjukkan bahwa kesalahan prediksi dan deviasi rata-rata antara nilai prediksi dan aktual lebih besar dibandingkan dengan model ensemble bagging. Secara keseluruhan, meskipun kedua model memiliki potensi untuk digunakan, ensemble bagging terbukti lebih efektif dalam menghasilkan prediksi yang lebih akurat pada dataset ini, meskipun keduanya masih memiliki ruang untuk perbaikan lebih lanjut.</p>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    // Variabel untuk menyimpan workbook
    let workbook;

    // Fungsi untuk membaca dan menampilkan file Excel
    function loadExcel(fileUrl) {
      fetch(fileUrl)
        .then((response) => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.arrayBuffer();
        })
        .then((data) => {
          // Baca file Excel
          workbook = XLSX.read(data, { type: "array" });

          // Isi dropdown dengan nama sheet
          const sheetSelector = document.getElementById('sheetSelector');
          workbook.SheetNames.forEach((sheetName, index) => {
            const option = document.createElement('option');
            option.value = index;
            option.textContent = sheetName;
            sheetSelector.appendChild(option);
          });

          // Menampilkan sheet pertama secara default
          loadSheetData();
        })
        .catch((error) => {
          console.error("Error loading Excel file:", error);
          alert("Terjadi kesalahan saat memuat file Excel. Pastikan file berada di lokasi yang benar.");
        });
    }

    // Fungsi untuk memuat data sheet yang dipilih
    function loadSheetData() {
      const sheetSelector = document.getElementById('sheetSelector');
      const selectedIndex = sheetSelector.value;

      // Jika tidak ada sheet yang dipilih, keluar
      if (selectedIndex === "") {
        return;
      }

      // Ambil sheet yang dipilih
      const sheetName = workbook.SheetNames[selectedIndex];
      const sheet = workbook.Sheets[sheetName];

      // Konversi sheet ke JSON
      const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

      // Render data ke tabel HTML
      const table = document.getElementById("excelTable");
      table.innerHTML = ""; // Kosongkan tabel sebelumnya

      rows.forEach((row) => {
        const tr = document.createElement("tr");
        row.forEach((cell) => {
          const td = document.createElement("td");
          td.textContent = cell || ""; // Isi cell (kosong jika null)
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
    }

    // Panggil fungsi untuk memuat file Excel (periksa lokasi file)
    loadExcel("p2_project.xlsx");
  </script>
</body>
</html>
